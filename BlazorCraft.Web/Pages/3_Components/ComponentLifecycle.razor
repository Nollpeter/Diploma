@page "/components/component-lifecycle"
@using BlazorCraft.Web.Shared.Examples.Components.LifeCycle
@using BlazorCraft.Web.Shared.Examples.Components.LifeCycle.ExampleUsages
<MudText Typo="Typo.h4">Component lifecycle events</MudText>
<MudText>
    Blazor components offer several virtual methods that allow us to modify our application's behavior.
    These methods get invoked at various points throughout a component's lifecycle.
    The following diagram illustrates the sequence in which these lifecycle methods are called
</MudText>
<MudImage Src="\img\component-lifecycle.jpg"/>
<MudExpansionPanels MultiExpansion="true">
    <MudExpansionPanelWithStoredState Id="SetParametersAsync">
        <TitleContent>
            <MudText Typo="Typo.h5" Class="fw-bold">SetParametersAsync</MudText>
        </TitleContent>
        <ChildContent>
            <div class="d-grid gap-3">
                <MudText>This method is executed whenever the parent renders.</MudText>
                <MudText>Parameters that were passed into the component are contained in a ParameterView. This is a good point at which to make asynchronous calls to a server (for example) based on the state passed into the component.</MudText>
                <MudText>The component’s [Parameter] properties are assigned their values when you call base.SetParametersAsync(parameters) inside your override.</MudText>
                <MudText>It is also the correct place to assign default parameter values. See Optional route parameters for a full explanation.</MudText>
            </div>
        </ChildContent>
    </MudExpansionPanelWithStoredState>
    <MudExpansionPanelWithStoredState Id="OnInitialized ">
        <TitleContent>
            <MudText Typo="Typo.h5" Class="fw-bold">OnInitialized / OnInitializedAsync</MudText>
        </TitleContent>
        <ChildContent>
            <div class="d-grid gap-3">
                <MudText>
                    Once the state from the ParameterCollection has been assigned to the component's <strong>[Parameter]</strong> properties, these methods are executed.
                    This is useful in the same way as SetParametersAsync, except it is possible to use the component's state.
                </MudText>
                <MudText>
                    * This method is only executed once when the component is first created.
                    If the parent changes the component's parameters at a later time, this method is skipped.
                </MudText>
                <MudText>
                    Note: When the component is a @("@page"), and our Blazor app navigates to a new URL that renders the same page, Blazor will reuse the current object instance for that page.
                    Because the object is the same instance, Blazor does not call IDisposable.Dispose on the object, nor does it execute its OnInitialized method again.
                </MudText>
            </div>
        </ChildContent>
    </MudExpansionPanelWithStoredState>
    <MudExpansionPanelWithStoredState Id="OnParametersSet  ">
        <TitleContent>
            <MudText Typo="Typo.h5" Class="fw-bold">OnParametersSet / OnParametersSetAsync</MudText>
        </TitleContent>
        <ChildContent>
            <div class="d-grid gap-3">
                <MudText>
                    This method will be executed immediately after OnInitializedAsync if this is a new instance of a component.
                    If it is an existing component that is being re-rendered because its parent is re-rendering then the OnInitialized* methods will not be executed, and this method will be executed immediately after SetParametersAsync instead
                </MudText>
            </div>
        </ChildContent>
    </MudExpansionPanelWithStoredState>
    <MudExpansionPanelWithStoredState Id="StateHasChanged">
        <TitleContent>
            <MudText Typo="Typo.h5" Class="fw-bold">StateHasChanged</MudText>
        </TitleContent>
        <ChildContent>
            <div class="d-grid gap-3">
                <MudText>This method flags the component to be rendered.</MudText>
                <MudText>A component will call this method whenever it wants to inform Blazor that changes have occurred that would result in the rendered output being different</MudText>
                <MudText>Consider the following example:</MudText>
                <CompanionSnippets TComponent="StateHasChangedExample" TUsage="StateHasChangedExampleUsage"/>
                
                <MudText>Without calling <strong>StateHasChanged()</strong>, this component would always show "Elapsed seconds: 0"</MudText>
            </div>
        </ChildContent>
    </MudExpansionPanelWithStoredState>
    <MudExpansionPanelWithStoredState Id="ShouldRender">
        <TitleContent>
            <MudText Typo="Typo.h5" Class="fw-bold">ShouldRender</MudText>
        </TitleContent>
        <ChildContent>
            <div class="d-grid gap-3">
                <MudText>
                    This method can be used to prevent the component's RenderTree from being recalculated by returning false.
                    Note that this method is not executed the first time a component is created and rendered.
                </MudText>
                <MudText>
                    Instructing Blazor not to go through the BuildRenderTree process can save processing time and improve the user's experience when we know that our state is either unaltered since the last render, or only altered in a way that would cause identical output to be rendered.
                </MudText>
                <MudText Class="italic">
                    * This method is not executed the first time the component is rendered.
                </MudText>
            </div>
        </ChildContent>
    </MudExpansionPanelWithStoredState>
    <MudExpansionPanelWithStoredState Id="OnAfterRender">
        <TitleContent>
            <MudText Typo="Typo.h5" Class="fw-bold">OnAfterRender / OnAfterRenderAsync</MudText>
        </TitleContent>
        <ChildContent>
            <div class="d-grid gap-3">
                <MudText>
                    These last two methods are executed every time Blazor has re-generated the component's RenderTree.
                    This can be as a result of the component's parent re-rendering, the user interacting with the component (e.
                    g.
                    a mouse-click), or if the component executes its StateHasChanged method to invoke a re-render.
                </MudText>
                <MudText>
                    These methods have a single parameter named firstRender.
                    This parameter is true only the first time the method is called on the current component, from there onwards it will always be false.
                    In cases where additional component hook-up is required (for example, via JavaScript) it is useful to know this is the first render.
                </MudText>
                <MudText>
                    It is not until after the OnAfterRender methods have executed that it is safe to use any references to components set via the @("@ref") directive.
                </MudText>
                <CodeSnippet>
                    @("""<ChildComponent @ref=MyReferenceToChildComponent/>"""+"\n"+
                    "\n"+
                    """@code"""+"\n"+
                    """{"""+"\n"+
                    """    // This will be null until the OnAfterRender\* methods execute"""+"\n"+
                    """    ChildComponent MyReferenceToChildComponent;"""+"\n"+
                    """}"""+"\n")
                </CodeSnippet>
                <MudText>And it is not until after the OnAfterRender methods have been executed with firstRender set to true that it is safe to use any references to HTML elements set via the @("@ref") directive.</MudText>
                <CodeSnippet>
                    @("""<h1 @ref=MyReferenceToAnHtmlElement>Hello</h1>"""+"\n"+
                    "\n"+
                    """@code"""+"\n"+
                    """{"""+"\n"+
                    """    // This will be null until the OnAfterRender\* methods execute"""+"\n"+
                    """    // with firstRender set to true"""+"\n"+
                    """    ElementReference MyReferenceToAnHtmlElement;"""+"\n"+
                    """}"""+"\n")
                </CodeSnippet>
            </div>
        </ChildContent>
    </MudExpansionPanelWithStoredState>
</MudExpansionPanels>


<MudDivider></MudDivider>

@code {

}